{% extends "base.html" %}

{% load static %} {% load manager_custom_tags %}

{% block title %} Management - Mes Oeuvres {% endblock title %}

{% block content %}

<div class="flex">
  {% include "manager/partials/sidebar.html" %}

  <div class="main-content flex-grow-1 p-4">
    {% topbar "Mes oeuvres" user %}

    <div class="container">
      <div class="row">
        <div class="flex justify-between items-center col-12 mb-3 m-O p-0">
          <form method="post" class="flex item-center justify-center gap-3">
            <input
              type="text"
              class="form-control"
              name="search-artwork"
              placeholder="Recherche..."
            />
            <button type="submit" class="btn btn-red" title="search">
              <i class="bx bx-search"></i>
            </button>
          </form>
          <a class="btn btn-black" href="#">Ajouter une oeuvre</a>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div
          class="wow animate__animated animate__slideInUp col-12"
          data-wow-delay="1.5s"
        >
          <table class="table table-striped table-hover">
            <thead class="text-white">
              <tr class="table-head-row">
                <th class="artwork-image">Image</th>
                <th class="artwork-name">Titre de l'oeuvre</th>
                <th class="artwork-price">Prix</th>
                <th class="artwork-category">Catégorie</th>
                <th class="artwork-medium">Medium</th>
                <th class="artwork-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="artwork-list">
              {% for item in artworks %}
              <tr class="table-body-row">
                <td class="artwork-image">
                  <img
                    src="{{ item.thumbnail.url }}"
                    alt="{{ item.title }}"
                    class="img-fluid"
                  />
                </td>
                <td class="artwork-name">{{ item.title }}</td>
                <td class="artwork-price">{{ item.price }} €</td>
                <td class="artwork-category">{{ item.category.name }}</td>
                <td class="artwork-medium">{{ item.medium.name }}</td>
                <td
                  class="artwork-actions flex items-center justify-center h-full"
                >
                  <a
                    href="{% url 'manager:artwork-detail' item.id %}"
                    class="btn btn-black btn-sm"
                    >Détail</a
                  >
                  <button
                    x-data="ArtworkHandler()"
                    x-on:click="removeArtwork('{{ item.id }}')"
                    class="btn btn-danger btn-sm"
                    title="Supprimer l'œuvre"
                  >
                    <i class="bx bx-trash-alt"></i>
                  </button>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="6" class="text-center">Aucune œuvre trouvée.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div
          class="mt-5 wow animate__animated animate__zoomIn flex justify-center items-end gap-3"
        >
          {% if artworks.has_previous %}
          <a
            href="?page={{ artworks.previous_page_number }}"
            class="text-black text-2xl bx bx-chevron-left"
          ></a>
          {% else %}
          <span class="text-gray-600 text-2xl bx bx-chevron-left"></span>
          {% endif %}

          <span class="text-gray-600"
            >Page {{ artworks.number }} sur {{ artworks.paginator.num_pages }}</span
          >

          {% if artworks.has_next %}
          <a
            href="?page={{ artworks.next_page_number }}"
            class="text-black text-2xl bx bx-chevron-right"
          ></a>
          {% else %}
          <span class="text-gray-600 text-2xl bx bx-chevron-right"></span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  {% endblock content %}
</div>
